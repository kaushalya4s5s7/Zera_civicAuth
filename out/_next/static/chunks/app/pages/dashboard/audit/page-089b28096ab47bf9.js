(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{30814:(e,t,s)=>{"use strict";async function n(e){let{messages:t,model:s="mistral-small-latest",temperature:n=.7,maxTokens:a=2e3}=e;try{let e=await fetch("https://api.mistral.ai/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat("4Hk5KPNIv56QTS9Gnr3PPW8Xw3k2afBt")},body:JSON.stringify({model:s,messages:t,temperature:n,max_tokens:a})});if(!e.ok){let t=await e.text();throw Error("Mistral API error: ".concat(e.status," - ").concat(t))}return(await e.json()).choices[0].message.content}catch(e){throw console.error("Error calling Mistral AI:",e),e}}async function a(e,t){return n({messages:[{role:"system",content:"You are an expert blockchain developer. Create a secure, optimized ".concat(t," smart contract based on the user's requirements. Return only the Solidity code with proper comments.")},{role:"user",content:e}],temperature:.5})}async function r(e,t){return n({messages:[{role:"system",content:"You are a smart contract security expert. Analyze the following contract code for security vulnerabilities, potential gas optimizations and best practices. Focus on issues specific to ".concat(t," blockchain. Format your response with clear headings and bullet points. Include severity levels for each issue.")},{role:"user",content:e}],temperature:.3,maxTokens:3e3})}async function i(e,t){return n({messages:[{role:"system",content:"You are a technical documentation expert. Create comprehensive documentation for the following smart contract code in ".concat(t," style format. Include function descriptions, parameter details, return values, events, and usage examples. Format in markdown.")},{role:"user",content:e}],temperature:.4,maxTokens:3e3})}async function l(e,t){return n({messages:[{role:"system",content:"You are an expert in smart contract testing. Create comprehensive test cases for the following smart contract code using the ".concat(t," testing framework. Include tests for all functions, edge cases, and error conditions. Return only the test code with proper comments.")},{role:"user",content:e}],temperature:.4,maxTokens:3e3})}function o(){return{passed:Math.floor(3*Math.random())+3,failed:Math.floor(2*Math.random()),results:[{id:1,name:"Should set the right owner",status:"passed",duration:"0.23s"},{id:2,name:"Should assign total supply to owner",status:"passed",duration:"0.18s"},{id:3,name:"Should transfer tokens between accounts",status:"passed",duration:"0.45s"},{id:4,name:"Should fail if sender doesn't have enough tokens",status:Math.random()>.7?"failed":"passed",duration:"0.32s",error:"Contract was expected to revert with 'Not enough tokens', but didn't revert."},{id:5,name:"Should update balances after transfers",status:"passed",duration:"0.38s"}],gasUsage:[{function:"transfer",cost:48325,improvement:"+12%"},{function:"approve",cost:32750,improvement:"+5%"},{function:"transferFrom",cost:53420,improvement:"-3%"}]}}s.d(t,{B2:()=>l,CF:()=>i,Dk:()=>o,Hu:()=>r,nr:()=>a})},40202:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>A});var n=s(95155),a=s(12115),r=s(83866),i=s(51154),l=s(85690),o=s(1243),c=s(87481);let d=[{id:"ethereum",name:"Ethereum"},{id:"polygon",name:"Polygon"},{id:"arbitrum",name:"Arbitrum"},{id:"optimism",name:"Optimism"},{id:"bsc",name:"BSC"},{id:"avalanche",name:"Avalanche"}],u=e=>{let{onAnalyze:t,isAnalyzing:s}=e,[r,u]=(0,a.useState)('// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\nimport "@openzeppelin/contracts/token/ERC20/IERC20.sol";\n\ncontract Vault {\n    address public owner;\n    mapping(address => uint256) public balances;\n    IERC20 public token;\n\n    constructor(address _tokenAddress) {\n        owner = msg.sender;\n        token = IERC20(_tokenAddress);\n    }\n\n    function deposit(uint256 amount) external {\n        require(token.transferFrom(msg.sender, address(this), amount), "Transfer failed");\n        balances[msg.sender] += amount;\n    }\n\n    function withdraw(uint256 amount) external {\n        require(balances[msg.sender] >= amount, "Insufficient balance");\n        // Vulnerable to reentrancy\n        token.transfer(msg.sender, amount);\n        balances[msg.sender] -= amount;\n    }\n\n    function getBalance(address user) external view returns (uint256) {\n        return balances[user];\n    }\n}'),[m,p]=(0,a.useState)("ethereum"),{toast:h}=(0,c.dj)();return(0,n.jsx)("div",{className:"grid grid-cols-1 gap-6 mb-6",children:(0,n.jsxs)("div",{className:"bg-white/10 backdrop-blur border border-white/20 rounded-xl p-6",children:[(0,n.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Smart Contract Analysis"}),(0,n.jsx)("p",{className:"text-sm text-gray-300 mt-1",children:"Our AI will scan your contract for security vulnerabilities"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("label",{htmlFor:"chain",className:"text-sm text-gray-300 mr-2",children:"Chain:"}),(0,n.jsx)("select",{id:"chain",value:m,onChange:e=>p(e.target.value),className:"bg-white/5 border border-white/20 text-white rounded-lg px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-primary",children:d.map(e=>(0,n.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,n.jsx)("button",{onClick:()=>{if(!r.trim())return void h({title:"Empty Code",description:"Please enter some code to analyze",variant:"destructive"});t(r,m)},disabled:s,className:"px-6 py-2 rounded-lg bg-primary text-white hover:bg-primary/80 transition-colors flex items-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed",children:s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.A,{className:"w-4 h-4 animate-spin"}),(0,n.jsx)("span",{children:"Analyzing..."})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.A,{className:"w-4 h-4"}),(0,n.jsx)("span",{children:"Analyze"})]})})]})]}),(0,n.jsxs)("div",{className:"bg-black rounded-xl border border-white/10 overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex bg-black justify-between items-center px-4 py-2 border-b border-white/10",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)("div",{className:"flex gap-1.5",children:[(0,n.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),(0,n.jsx)("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),(0,n.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"})]}),(0,n.jsx)("span",{className:"text-sm text-gray-400",children:"Vault.sol"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 text-yellow-400",children:[(0,n.jsx)(o.A,{className:"w-4 h-4"}),(0,n.jsx)("span",{className:"text-xs",children:"AI will identify potential security issues"})]})]}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("textarea",{value:r,onChange:e=>u(e.target.value),className:"w-full h-[400px] bg-transparent p-4 text-gray-100 font-mono text-sm focus:outline-none resize-none",spellCheck:"false",placeholder:"Paste your smart contract code here..."}),(0,n.jsx)("div",{className:"absolute left-0 top-[169px] right-0 h-[24px] bg-red-500/10 border-l-4 border-red-500"}),(0,n.jsx)("div",{className:"absolute left-0 top-[193px] right-0 h-[24px] bg-red-500/10 border-l-4 border-red-500"})]})]})]})})};var m=s(85339),p=s(81284),h=s(94083);let x=e=>{let{severity:t}=e,s=t||"unknown";return(0,n.jsxs)("div",{className:"px-2 py-0.5 rounded text-xs border flex items-center gap-1 ".concat((()=>{switch(t){case"critical":return"bg-red-500/20 text-red-400 border-red-500";case"high":return"bg-orange/20 text-orange border-orange";case"medium":return"bg-yellow-500/20 text-yellow-400 border-yellow-500";case"low":return"bg-blue-500/20 text-blue-400 border-blue-500";default:return"bg-gray-500/20 text-gray-400 border-gray-500"}})()),children:[(()=>{switch(s){case"critical":case"high":return(0,n.jsx)(o.A,{className:"w-3 h-3"});case"medium":return(0,n.jsx)(m.A,{className:"w-3 h-3"});default:return(0,n.jsx)(p.A,{className:"w-3 h-3"})}})(),(0,n.jsx)("span",{children:s.charAt(0).toUpperCase()+s.slice(1)})]})},y=()=>{let[e,t]=(0,a.useState)(null),{issues:s,auditScore:r,auditReport:i,issueCount:l}=(0,h.A)();return console.log("Issues in AuditResults:",s),console.log("Audit Report in AuditResults:",i),console.log("Score in AuditResults:",r),(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,n.jsxs)("div",{className:"lg:col-span-4 bg-white/10 backdrop-blur border border-white/20 rounded-xl p-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Audit Summary"}),(0,n.jsxs)("p",{className:"text-sm text-gray-300",children:["Overall Security Score:"," ",(0,n.jsxs)("span",{className:"font-bold ".concat(r>=80?"text-green-400":r>=60?"text-yellow-400":"text-red-400"),children:[r,"%"]})]}),(0,n.jsx)("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-5 gap-4",children:Object.entries(l).map(e=>{let[t,s]=e;return(0,n.jsxs)("div",{className:"flex flex-col items-center bg-black/20 p-4 rounded-lg",children:[(0,n.jsx)(x,{severity:t}),(0,n.jsx)("span",{className:"text-white font-medium mt-2",children:s}),(0,n.jsx)("span",{className:"text-gray-400 text-xs capitalize",children:t})]},t)})})]}),(0,n.jsxs)("div",{className:"lg:col-span-4 bg-white/10 backdrop-blur border border-white/20 rounded-xl p-6 mt-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Detailed Issues"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,n.jsx)("div",{className:"md:col-span-1 bg-black/20 rounded-lg p-4 overflow-auto max-h-[500px]",children:s.length>0?s.map(s=>(0,n.jsxs)("div",{onClick:()=>t(s),className:"p-3 mb-2 rounded-lg cursor-pointer border ".concat((null==e?void 0:e.id)===s.id?"border-primary bg-primary/10":"border-white/10 hover:bg-white/5"),children:[(0,n.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,n.jsx)("div",{className:"text-sm text-white font-medium truncate pr-2",children:s.title}),(0,n.jsx)(x,{severity:s.severity})]}),(0,n.jsxs)("div",{className:"text-xs text-gray-400",children:[s.source," ",s.line?"• Line ".concat(s.line):""]})]},s.id)):(0,n.jsx)("div",{className:"text-gray-400 text-sm text-center",children:"No issues found."})}),(0,n.jsx)("div",{className:"md:col-span-2 bg-black/20 rounded-lg p-4",children:e?(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h4",{className:"text-white font-medium",children:e.title}),(0,n.jsx)(x,{severity:e.severity})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("div",{className:"text-xs text-gray-400 mb-1",children:"Source"}),(0,n.jsx)("div",{className:"text-sm text-white",children:e.source})]}),e.line&&(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("div",{className:"text-xs text-gray-400 mb-1",children:"Location"}),(0,n.jsxs)("div",{className:"text-sm text-white",children:["Line ",e.line]})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("div",{className:"text-xs text-gray-400 mb-1",children:"Description"}),(0,n.jsx)("div",{className:"text-sm text-white whitespace-pre-wrap",children:e.description})]}),e.recommendation&&(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("div",{className:"text-xs text-gray-400 mb-1",children:"Recommendation"}),(0,n.jsx)("div",{className:"text-sm text-white",children:e.recommendation})]})]}):(0,n.jsx)("div",{className:"flex items-center justify-center h-full text-gray-400",children:"Select an issue to view details"})})]})]})]})};var g=s(30814),b=s(53099),f=s(193),v=s(5219),w=s(11681);console.log("useAuditStore:",h.A);let j=[{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"contractHash",type:"bytes32"},{indexed:!1,internalType:"uint8",name:"stars",type:"uint8"},{indexed:!1,internalType:"string",name:"summary",type:"string"},{indexed:!0,internalType:"address",name:"auditor",type:"address"},{indexed:!1,internalType:"uint256",name:"timestamp",type:"uint256"}],name:"AuditRegistered",type:"event"},{inputs:[{internalType:"bytes32",name:"contractHash",type:"bytes32"},{internalType:"uint8",name:"stars",type:"uint8"},{internalType:"string",name:"summary",type:"string"}],name:"registerAudit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"startIndex",type:"uint256"},{internalType:"uint256",name:"limit",type:"uint256"}],name:"getAllAudits",outputs:[{internalType:"bytes32[]",name:"contractHashes",type:"bytes32[]"},{internalType:"uint8[]",name:"stars",type:"uint8[]"},{internalType:"string[]",name:"summaries",type:"string[]"},{internalType:"address[]",name:"auditors",type:"address[]"},{internalType:"uint256[]",name:"timestamps",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"auditor",type:"address"}],name:"getAuditorHistory",outputs:[{internalType:"bytes32[]",name:"",type:"bytes32[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"contractHash",type:"bytes32"}],name:"getContractAudits",outputs:[{components:[{internalType:"uint8",name:"stars",type:"uint8"},{internalType:"string",name:"summary",type:"string"},{internalType:"address",name:"auditor",type:"address"},{internalType:"uint256",name:"timestamp",type:"uint256"}],internalType:"struct AuditRegistry.AuditEntry[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getContractHashByIndex",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"contractHash",type:"bytes32"}],name:"getLatestAudit",outputs:[{components:[{internalType:"uint8",name:"stars",type:"uint8"},{internalType:"string",name:"summary",type:"string"},{internalType:"address",name:"auditor",type:"address"},{internalType:"uint256",name:"timestamp",type:"uint256"}],internalType:"struct AuditRegistry.AuditEntry",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[],name:"getTotalContracts",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}],N=e=>{let t=[],s=e.split("\n"),n={};return s.forEach(e=>{e.startsWith("####")?(n.id&&t.push(n),n={id:"undefined"!=typeof crypto&&"function"==typeof crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),title:e.replace(/####/,"").trim()}):e.startsWith("- **Description**:")?n.description=e.replace(/- \*\*Description\*\*:/,"").trim():e.startsWith("- **Affected Function**:")?n.source=e.replace(/- \*\*Affected Function\*\*:/,"").trim():e.startsWith("- **Mitigation**:")?n.recommendation=e.replace(/- \*\*Mitigation\*\*:/,"").trim():e.startsWith("- **Severity**:")&&(n.severity=e.replace(/- \*\*Severity\*\*:/,"").trim().toLowerCase())}),n.id&&t.push(n),console.log("Parsed Issues:",t),t},A=()=>{let[e,t]=(0,a.useState)(!1),[s,i]=(0,a.useState)(!1),[l,o]=(0,a.useState)(!1),{toast:d}=(0,c.dj)(),{auditScore:m,auditReport:p,contractHash:x,isLocked:A,setAuditScore:k,setAuditReport:T,setContractHash:S,setIssues:C,setIssueCount:I,setIsLocked:M}=(0,h.A)(),R=async(e,s)=>{if(!e.trim())return void d({title:"Empty Code",description:"Please enter some code to analyze",variant:"destructive"});i(!0);try{let n=await (0,g.Hu)(e,s);T(n);let a=(()=>{let t=Date.now().toString(),s=Math.random().toString(),n="".concat(t,"-").concat(s,"-").concat(e.length);return(0,b.S)((0,f.YW)(n))})();S(a);let r=N(n);C(r);let i=n.toLowerCase(),l=(i.match(/critical/g)||[]).length,o=(i.match(/high/g)||[]).length,c=(i.match(/medium/g)||[]).length,u=(i.match(/low/g)||[]).length,m=(i.match(/info/g)||[]).length;I({critical:l,high:o,medium:c,low:u,info:m});let p=5*l+3*o+2*c+u,h=Math.max(100-2*p,40);k(h),t(!0),M(!0),d({title:"Audit Complete",description:"Audit completed with a score of ".concat(h,"%. Please register the audit on-chain to view details.")})}catch(e){console.error("Error analyzing contract:",e),d({title:"Audit Failed",description:"An error occurred during the audit. Please try again.",variant:"destructive"})}finally{i(!1)}},E=async()=>{if(!window.ethereum)return void d({title:"No Wallet Detected",description:"Please install MetaMask or another Ethereum wallet.",variant:"destructive"});if(!x||!p)return void d({title:"Invalid Input",description:"Failed to register audit. Missing required data.",variant:"destructive"});try{o(!0);let e=new v.k(window.ethereum);await e.send("eth_requestAccounts",[]);let t=await e.getSigner(),s=new w.NZ("0x311799344e53106315cbDe72649d7eD8De9A1bfA",j,t),n=await s.registerAudit(x,Math.floor(m/20),p);await n.wait(),d({title:"Audit Registered",description:"The audit has been successfully registered on-chain."}),M(!1)}catch(e){console.error("Error registering audit:",e),d({title:"Error",description:"Failed to register the audit on-chain.",variant:"destructive"})}finally{o(!1)}};return(0,n.jsxs)(r.A,{children:[(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-white mb-1",children:"Security Audit"}),(0,n.jsx)("p",{className:"text-gray-300",children:"Analyze your smart contracts for vulnerabilities and security issues."})]}),(0,n.jsx)(u,{onAnalyze:R,isAnalyzing:s}),e&&(0,n.jsxs)("div",{children:[A&&(0,n.jsxs)("div",{className:"bg-black/80 backdrop-blur border border-white/20 rounded-xl p-6 text-center",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Audit Results Locked"}),(0,n.jsx)("p",{className:"text-gray-300 mb-6",children:"To unlock the audit results, please register the audit on-chain."}),(0,n.jsx)("button",{onClick:E,disabled:l,className:"px-6 py-2 rounded-lg bg-primary text-white hover:bg-primary/80 transition-colors flex items-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed",children:l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"animate-spin",children:"↻"}),(0,n.jsx)("span",{children:"Registering..."})]}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("span",{children:"Register Audit"})})})]}),!A&&(0,n.jsx)(y,{})]})]})}},93139:(e,t,s)=>{Promise.resolve().then(s.bind(s,40202))},94083:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});let n=(0,s(65453).v)()(e=>({auditScore:0,auditReport:"",contracts:[],contractHash:"",issues:[],issueCount:{critical:0,high:0,medium:0,low:0,info:0},isLocked:!0,setContracts:t=>e({contracts:t}),setAuditScore:t=>e({auditScore:t}),setAuditReport:t=>e({auditReport:t}),setContractHash:t=>e({contractHash:t}),setIssues:t=>e({issues:t}),setIssueCount:t=>e({issueCount:t}),setIsLocked:t=>e({isLocked:t}),resetAuditState:()=>e({auditScore:0,auditReport:"",contractHash:"",contracts:[],issues:[],issueCount:{critical:0,high:0,medium:0,low:0,info:0},isLocked:!0})}))}},e=>{var t=t=>e(e.s=t);e.O(0,[110,371,219,272,866,441,684,358],()=>t(93139)),_N_E=e.O()}]);